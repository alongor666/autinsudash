<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>客户类别组合测试</title>
</head>
<body>
    <h1>客户类别组合测试</h1>
    <div id="test-results"></div>

    <script>
        // 模拟客户类别组合配置
        const customerCategoryCombinations = [
            {
                name: '私家车',
                description: '仅选择“非营业个人客车”',
                matchFunction: (selected) => selected.size === 1 && selected.has('非营业个人客车')
            },
            {
                name: '单位客车',
                description: '选择“非营业企业客车”与/或“非营业机关客车”',
                matchFunction: (selected) => {
                    const target = ['非营业企业客车', '非营业机关客车'];
                    return selected.size > 0 && Array.from(selected).every(item => target.includes(item));
                }
            },
            {
                name: '非营客车组合',
                description: '同时选择所有非营业客车（个人、企业、机关）',
                matchFunction: (selected) => {
                    const nonCommercial = ['非营业个人客车', '非营业企业客车', '非营业机关客车'];
                    const hasAll = nonCommercial.every(item => selected.has(item));
                    return selected.size === nonCommercial.length && hasAll;
                }
            }
        ];

        // 测试用例
        const testCases = [
            {
                name: '私家车测试',
                selectedTypes: ['非营业个人客车'],
                expectedAlias: '私家车'
            },
            {
                name: '单位客车测试',
                selectedTypes: ['非营业企业客车', '非营业机关客车'],
                expectedAlias: '单位客车'
            },
            {
                name: '非营客车组合测试',
                selectedTypes: ['非营业个人客车', '非营业企业客车', '非营业机关客车'],
                expectedAlias: '非营客车组合'
            }
        ];

        // 运行测试
        function runTests() {
            const resultsDiv = document.getElementById('test-results');
            let html = '<h2>测试结果</h2>';

            testCases.forEach(testCase => {
                const selectedSet = new Set(testCase.selectedTypes);
                let matchedAlias = null;

                for (const combination of customerCategoryCombinations) {
                    if (combination.matchFunction(selectedSet)) {
                        matchedAlias = combination.name;
                        break;
                    }
                }

                const passed = matchedAlias === testCase.expectedAlias;
                html += `
                    <div style="margin: 10px 0; padding: 10px; border: 1px solid ${passed ? 'green' : 'red'}; background: ${passed ? '#e8f5e8' : '#ffe8e8'};">
                        <h3>${testCase.name}</h3>
                        <p><strong>选择类别:</strong> ${testCase.selectedTypes.join(', ')}</p>
                        <p><strong>期望组合:</strong> ${testCase.expectedAlias}</p>
                        <p><strong>实际组合:</strong> ${matchedAlias || '无匹配'}</p>
                        <p><strong>测试结果:</strong> ${passed ? '✅ 通过' : '❌ 失败'}</p>
                    </div>
                `;
            });

            resultsDiv.innerHTML = html;
        }

        // 页面加载后运行测试
        window.onload = runTests;
    </script>
</body>
</html>
